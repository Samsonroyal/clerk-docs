---
title: verifyToken()
description: Use Clerk's Backend SDK to
---

# `verifyToken()`



```js
function verifyToken: (token: string, options: VerifyTokenOptions) => Promise<JwtReturnType<JwtPayload, TokenVerificationError>>;
```

## Parameters

| Name | Type | Description |
| --- | --- | --- |
| `token` | `string` | The token to verify. |
| `options` | `VerifyTokenOptions` | Options for verifying the token. |

### `VerifyTokenOptions`

| Name | Type | Description |
| --- | --- | --- |
| `audience?` | `string \| string[]` | A string or list of [audiences](https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.3). |
| `authorizedParties`| `string[]` | | A list of authorized parties. For example, `['http://localhost:4003', 'https://clerk.com']` |
| `clockSkewInMs?` | `number` | Specifies the allowed time difference (in milliseconds) between the Clerk server (which generates the token) and the clock of the user's application server when validating a token. Defaults to 5000 ms (5 seconds).|
| `jwtKey?` | `string` | The PEM public key from the **[API Keys](https://dashboard.clerk.com/last-active?path=api-keys) page -> Show JWT public key -> JWKS URL** section of the Clerk Dashboard. It's recommended to use [the environment variable](/docs/deployments/clerk-environment-variables) instead. |
| `secretKey?` | `string` | The Clerk secret key from the [API Keys](https://dashboard.clerk.com/last-active?path=api-keys) page in the Clerk Dashboard.  |
| `skipJwksCache?` | `boolean` | A flag to skip ignore cache and always fetch JWKs before each jwt verification.|
| `apiUrl?` | `string` |  |
| `apiVersion?` | `string` |  |

## Example

The following example demonstrates how to use `verifyToken()` in a Next.js application.

```ts title="app/api/verify-token/route.ts"
import { verifyToken } from '@clerk/backend';
import { cookies } from 'next/headers';

export async function GET(request: Request) {
  const cookieStore = cookies()
  const sessToken = cookieStore.get('__session')?.value
  const bearerToken = request.headers.get('Authorization')?.replace('Bearer ', '');
  const token = sessToken || bearerToken;

  if (!token) {
    return Response.json({ error: 'Token not found. User must sign in.' }, { status: 401 });
  }

  try {
    const verifiedSession = await verifyToken(token, {
      jwtKey: process.env.CLERK_JWT_KEY,
    });

    // Check if the token is expired or not yet valid
    const currentTime = Math.floor(Date.now() / 1000);
    if (verifiedSession.exp < currentTime || verifiedSession.nbf > currentTime) {
      throw new Error("Token is expired or not yet valid");
    }

    // Check if the token is issued by a permitted origin
    const permittedOrigins = ["http://localhost:3000", "https://example.com"]; // Replace with your permitted origins
    if (verifiedSession.azp && !permittedOrigins.includes(verifiedSession.azp)) {
      throw new Error("Invalid 'azp' claim");
    }

    return Response.json({ verifiedSession });
  } catch (error) {
    return Response.json({ error: 'Token not verified.' }, { status: 401 });
  }
}
```

If the token is valid, the response will contain a JSON object that looks something like this:

```json
{
  "verifiedSession": {
    "azp": "http://localhost:3000",
    "exp": 1687906422,
    "iat": 1687906362,
    "iss": "https://magical-marmoset-51.clerk.accounts.dev",
    "nbf": 1687906352,
    "sid": "sess_2Ro7e2IxrffdqBboq8KfB6eGbIy",
    "sub": "user_2RfWKJREkjKbHZy0Wqa5qrHeAnb"
  }
}
```
